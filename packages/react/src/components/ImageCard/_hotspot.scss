@use '../../globals/theme';
@use '../../globals/spacing';
@use '../../globals/vars';
@use '../../globals/mixins';
@use '../../globals/colors';
@use '../../globals/typography';

// Part of the css and the colors used come from old StyledComponents code
// and should be replaced with actual carbon colors and design. See issue 1806
$selected-border-width: spacing.$spacing-01;
$selected-border: solid $selected-border-width theme.$interactive-04;

// The custom properties --x-pos, --y-pos, --width, --height are set
// on the container by the react js code. They do not include units.
.#{vars.$iot-prefix}--hotspot-container {
  position: absolute;
  font-family: Sans-Serif;
  pointer-events: auto;
  top: calc((var(--y-pos) * 1%) - ((var(--height) / 2) * 1px));
  left: calc((var(--x-pos) * 1%) - ((var(--width) / 2) * 1px));
}

// FIXED OR DYNAMIC HOTSPOT (USING TOOLTIP)
.#{vars.$iot-prefix}--hotspot-container--is-fixed,
.#{vars.$iot-prefix}--hotspot-container--is-dynamic {
  &.#{vars.$iot-prefix}--hotspot-container--selected {
    $padding: spacing.$spacing-02;

    box-sizing: border-box;
    border: $selected-border;
    padding: #{$padding};
    top: calc(
      (var(--y-pos) * 1%) - (((var(--height) * 1px) / 2) + #{$padding} + #{$selected-border-width})
    );
    left: calc(
      (var(--x-pos) * 1%) - (((var(--width) * 1px) / 2) + #{$padding} + #{$selected-border-width})
    );
  }
  &.#{vars.$iot-prefix}--hotspot-container--has-icon {
    .#{vars.$prefix}--tooltip__label {
      border: solid 1px colors.$gray-40;
      cursor: pointer;
      padding: spacing.$spacing-02;
      background: colors.$white-0;
      opacity: 0.9;
      border-radius: 4px;
      @include mixins.box-shadow();
    }
  }

  .#{$prefix}--tooltip__label {
    display: flex;
    cursor: pointer;
    border-radius: 13px;
    background: none;
    @include mixins.box-shadow();
  }
}

.#{vars.$iot-prefix}--hotspot-container--is-dynamic.#{vars.$iot-prefix}--hotspot-container--selected {
  border-style: dashed;
}

// TEXT HOTSPOT
// The custom properties --bold, --italic, --background-color etc are set
// on the container by the react js code
.#{vars.$iot-prefix}--hotspot-container--is-text {
  &.#{vars.$iot-prefix}--hotspot-container--selected {
    box-sizing: border-box;
    border: $selected-border;
    top: calc((var(--y-pos) * 1%) - (((var(--height) * 1px) / 2)));
    left: calc((var(--x-pos) * 1%) - (((var(--width) * 1px) / 2)));
  }
}

.#{vars.$iot-prefix}--text-hotspot {
  $padding: spacing.$spacing-03;
  $min-width: spacing.$spacing-12;
  $text-input-height: spacing.$spacing-08;

  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: $padding;
  box-sizing: border-box;
  min-width: $min-width;
  min-height: $text-input-height;
  border-style: solid;
  background-color: var(--background-color);
  border-color: var(--border-color);
  border-width: calc(var(--border-width) * 1px);

  .#{vars.$iot-prefix}--hotspot-content {
    & > *:nth-child(2) {
      &.#{vars.$iot-prefix}--hotspot-content-attribute {
        margin-top: spacing.$spacing-03;
      }
    }

    h4 {
      @include typography.type-style('productive-heading-01');
      text-align: left;
      padding-bottom: 0;
      line-height: calc(var(--title-font-size) * 1.4px);
      font-weight: var(--title-font-weight);
      font-style: var(--title-font-style);
      text-decoration-line: var(--title-text-decoration-line);
      color: var(--title-font-color);
      // Linting expects size to be in rem, but user size is given in px.
      // font-size: calc(
      //   ((var(--title-font-size) * 1px) / 16px) * 1rem
      // );

      // stylelint-disable-next-line declaration-property-unit-blacklist
      font-size: calc(var(--title-font-size) * 1px);

      // Used to expand the hotspot while the user types into the TextInput
      &.#{vars.$iot-prefix}--hotspot-content-title__visually-hidden {
        visibility: hidden;
        height: 0px;
      }
    }
  }

  .#{vars.$iot-prefix}--hotspot-content-label-section {
    text-align: left;
  }
  .#{vars.$iot-prefix}--hotspot-content-label,
  .#{vars.$iot-prefix}--hotspot-content-threshold {
    @include typography.type-style('helper-text-01');
    font-weight: normal;
  }

  .#{vars.$iot-prefix}--hotspot-content-title-wrapper--editable {
    $negative-margin-to-overide-parent-padding: calc(-1 * (#{$padding}));
    margin: $negative-margin-to-overide-parent-padding;

    .#{vars.$iot-prefix}--hotspot-content-title-input {
      padding: 0 calc(#{$padding} + #{$selected-border-width});
      width: calc(
        (var(--width) * 1px) - (#{$selected-border-width} * 2) - (var(--border-width) * 1px * 2)
      );
      height: $text-input-height;
      border-bottom: none;
      &:focus {
        outline: none;
      }
    }
  }
}
