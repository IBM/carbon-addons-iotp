@use '../../globals/theme';
@use '../../globals/spacing';
@use '../../globals/vars';
@use '../../globals/mixins';
@use "../../globals/colors";

$shadow-plus-padding: 1.4rem;
$shadow: 0.4rem;

.#{vars.$iot-prefix}--flyout-menu {
  display: flex;

  &.#{vars.$iot-prefix}--flyout-menu__top {
    flex-direction: column-reverse;
  }

  &.#{vars.$iot-prefix}--flyout-menu__bottom {
    flex-direction: column;
  }

  &.#{vars.$iot-prefix}--flyout-menu__right,
  [dir='rtl'] &.#{vars.$iot-prefix}--flyout-menu__left {
    flex-direction: row;
  }

  &.#{vars.$iot-prefix}--flyout-menu__left,
  [dir='rtl'] &.#{vars.$iot-prefix}-flyout-menu__right {
    flex-direction: row-reverse;
  }

  &--body {
    color: initial;
    border-radius: 0;

    &:not(.#{vars.$iot-prefix}--flyout-menu--body__light) {
      background: theme.$ui-01;

      .#{vars.$prefix}--tooltip__content::after {
        background-color: theme.$ui-01;
      }
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__light {
      background: theme.$ui-02;

      .#{vars.$prefix}--tooltip__content::after {
        background-color: theme.$ui-02;
      }
    }

    .#{vars.$prefix}--tooltip__caret {
      display: none;
    }

    .#{vars.$prefix}--tooltip__content {
      position: relative;
      max-width: 480px;
    }

    // Box shadow cover with all its various positons
    &.#{vars.$iot-prefix}--flyout-menu--body__open .#{vars.$prefix}--tooltip__content::after {
      content: '';
      position: absolute;
      top: -(theme.$shadow);
      left: 0;
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__bottom-end .#{vars.$prefix}--tooltip__content::after {
      left: unset;
      right: 0;
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__top-start .#{vars.$prefix}--tooltip__content::after {
      top: unset;
      bottom: -(theme.$shadow);
      left: 0;
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__top-end .#{vars.$prefix}--tooltip__content::after {
      bottom: -(theme.$shadow);
      left: unset;
      right: 0;
      top: unset;
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__left-start .#{vars.$prefix}--tooltip__content::after {
      left: unset;
      right: -(theme.$shadow);
      top: 0;
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__left-end .#{vars.$prefix}--tooltip__content::after {
      display: none;
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__right-start
      .#{vars.$prefix}--tooltip__content::after {
      top: 0;
      left: -(theme.$shadow);
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__right-end .#{vars.$prefix}--tooltip__content::after {
      top: unset;
      bottom: 0;
      left: -(theme.$shadow);
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__bottom-start,
    &.#{vars.$iot-prefix}--flyout-menu--body__bottom-end,
    &.#{vars.$iot-prefix}--flyout-menu--body__top-start,
    &.#{vars.$iot-prefix}--flyout-menu--body__top-end {
      .#{vars.$prefix}--tooltip__content::after {
        width: 3rem;
        height: theme.$shadow;
      }
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__bottom-start.#{vars.$iot-prefix}--flyout-menu--body__field,
    &.#{vars.$iot-prefix}--flyout-menu--body__bottom-end.#{vars.$iot-prefix}--flyout-menu--body__field,
    &.#{vars.$iot-prefix}--flyout-menu--body__top-start.#{vars.$iot-prefix}--flyout-menu--body__field,
    &.#{vars.$iot-prefix}--flyout-menu--body__top-end.#{vars.$iot-prefix}--flyout-menu--body__field {
      .#{vars.$prefix}--tooltip__content::after {
        width: 2.5rem;
      }
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__bottom-start.#{vars.$iot-prefix}--flyout-menu--body__small,
    &.#{vars.$iot-prefix}--flyout-menu--body__bottom-end.#{vars.$iot-prefix}--flyout-menu--body__small,
    &.#{vars.$iot-prefix}--flyout-menu--body__top-start.#{vars.$iot-prefix}--flyout-menu--body__small,
    &.#{vars.$iot-prefix}--flyout-menu--body__top-end.#{vars.$iot-prefix}--flyout-menu--body__small {
      .#{vars.$prefix}--tooltip__content::after {
        width: 2rem;
      }
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__left-start,
    &.#{vars.$iot-prefix}--flyout-menu--body__left-end,
    &.#{vars.$iot-prefix}--flyout-menu--body__right-start,
    &.#{vars.$iot-prefix}--flyout-menu--body__right-end {
      .#{vars.$prefix}--tooltip__content::after {
        width: theme.$shadow;
        height: 3rem;
      }
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__left-start.#{vars.$iot-prefix}--flyout-menu--body__field,
    &.#{vars.$iot-prefix}--flyout-menu--body__left-end.#{vars.$iot-prefix}--flyout-menu--body__field,
    &.#{vars.$iot-prefix}--flyout-menu--body__right-start.#{vars.$iot-prefix}--flyout-menu--body__field,
    &.#{vars.$iot-prefix}--flyout-menu--body__right-end.#{vars.$iot-prefix}--flyout-menu--body__field {
      .#{vars.$prefix}--tooltip__content::after {
        height: 2.5rem;
      }
    }

    &.#{vars.$iot-prefix}--flyout-menu--body__left-start.#{vars.$iot-prefix}--flyout-menu--body__small,
    &.#{vars.$iot-prefix}--flyout-menu--body__left-end.#{vars.$iot-prefix}--flyout-menu--body__small,
    &.#{vars.$iot-prefix}--flyout-menu--body__right-start.#{vars.$iot-prefix}--flyout-menu--body__small,
    &.#{vars.$iot-prefix}--flyout-menu--body__right-end.#{vars.$iot-prefix}--flyout-menu--body__small {
      .#{vars.$prefix}--tooltip__content::after {
        height: 2rem;
      }
    }
  }

  &__shadow-block {
    display: block;
    position: absolute;
    background: theme.$ui-02;

    &.bottom-start {
      height: $shadow-plus-padding;
      top: -$shadow-plus-padding;
      left: 0;
    }

    &.bottom-end {
      height: $shadow-plus-padding;
      top: -$shadow-plus-padding;
      right: 0;
    }

    &.top-start {
      height: 0.375rem;
      bottom: -0.375rem;
      left: 0;
    }

    &.top-end {
      height: 0.375rem;
      bottom: -0.375rem;
      right: 0;
    }

    &.left-start {
      width: $shadow-plus-padding;
      right: -$shadow-plus-padding;
      top: 0;
    }

    &.left-end {
      width: $shadow-plus-padding;
      right: -$shadow-plus-padding;
      bottom: 0;
    }

    &.right-start {
      width: $shadow-plus-padding;
      left: -$shadow-plus-padding;
      top: 0;
    }

    &.right-end {
      width: $shadow-plus-padding;
      left: -$shadow-plus-padding;
      bottom: 0;
    }
  }

  &--tooltip-anchor {
    position: relative;
    height: 0px;
    width: 0px;
  }

  &__open {
    @include mixins.box-shadow;
  }

  &__bottom-container {
    min-width: 15.4rem;
    display: flex;

    > * {
      flex-grow: 1;
    }

    > button.#{vars.$iot-prefix}--btn {
      padding-right: 60px;
    }
  }

  &__bottom-container-custom {
    min-height: 64px;
    width: 100%;
  }
}

.#{vars.$iot-prefix}--flyout-menu--body.#{vars.$prefix}--tooltip {
  min-width: unset;
  max-width: unset;
  padding: 0;
}

.#{vars.$iot-prefix}--flyout-menu--content {
  padding: spacing.$spacing-05 spacing.$spacing-05 spacing.$spacing-09 spacing.$spacing-05;
}

.#{vars.$iot-prefix}--flyout-menu--trigger-button {
  color: theme.$icon-01;

  &.bx--btn.bx--btn--icon-only.bx--tooltip__trigger svg,
  &.bx--btn.bx--btn--icon-only.bx--tooltip__trigger:hover svg {
    fill: colors.$gray-70;
  }

  .#{vars.$iot-prefix}--flyout-menu:not(.#{vars.$iot-prefix}--flyout-menu__light) & {
    background-color: theme.$ui-01;
  }

  .#{vars.$iot-prefix}--flyout-menu:not(.#{vars.$iot-prefix}--flyout-menu__open) &:hover {
    background-color: theme.$hover-ui;
  }

  .#{vars.$iot-prefix}--flyout-menu__light.#{vars.$iot-prefix}--flyout-menu__open &:hover {
    background-color: theme.$ui-02;
  }

  &:focus {
    box-shadow: inset 0 0 0 2px theme.$focus, inset 0 0 0 3px theme.$ui-background;
  }

  .#{vars.$prefix}--btn.#{vars.$prefix}--btn--icon-only.#{vars.$prefix}--tooltip__trigger::before {
    width: 100%;
  }

  > svg {
    margin-left: 0;
  }

  // What are we doing with these tool tips for buttons. We will want to be consistent across all button types.
  .#{vars.$prefix}--assistive-text,
  &.#{vars.$prefix}--tooltip--a11y::before {
    visibility: var(--tooltip-visibility);
  }
}
